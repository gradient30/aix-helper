<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Helper</title>
  <script>
    (function () {
      var l = window.location;
      var params = new URLSearchParams(l.search);

      // 已经是中转参数时不再重写，避免 p/q 无限嵌套循环
      if (params.has('p')) return;

      // 自动识别 GitHub Pages 项目级子路径；Cloudflare Pages 根路径使用空 base
      var base = l.pathname.indexOf('/aix-helper/') === 0 || l.pathname === '/aix-helper'
        ? '/aix-helper'
        : '';

      var path = l.pathname;
      if (base && path.indexOf(base) === 0) {
        path = path.slice(base.length) || '/';
      }

      var target =
        (base || '') +
        '/?p=' +
        encodeURIComponent(path || '/') +
        (l.search ? '&q=' + encodeURIComponent(l.search.slice(1)) : '') +
        l.hash;

      l.replace(target);
    })();
  </script>
</head>
<body></body>
</html>
